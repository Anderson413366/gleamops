{
  "version": "v2-enterprise-expanded",
  "description": "Enterprise multi-tenant schema requirements",
  "tables": [
    {"name":"organizations","fields":["org_id","org_name","legal_name","duns_number","website_url","main_phone","address_line1","address_line2","city","state","postal_code","country","timezone","currency_code","status","data_retention_days","created_at","updated_at","deleted_at"]},
    {"name":"organization_settings","fields":["org_settings_id","org_id","default_invoice_terms","default_tax_rate","default_invoice_delivery","default_quote_valid_days","default_pay_period","default_language","enable_staging_mode","created_at","updated_at"]},
    {"name":"users","fields":["user_id","org_id","email","email_verified","password_hash","user_type","employee_id","client_contact_id","status","last_login_at","mfa_enabled","created_at","updated_at","deleted_at"]},
    {"name":"user_sessions","fields":["session_id","user_id","ip_address","user_agent","created_at","expires_at","revoked_at"]},
    {"name":"roles","fields":["role_id","org_id","role_name","role_kind","description","is_default","created_at","updated_at"]},
    {"name":"permissions","fields":["permission_id","permission_code","module","description","created_at"]},
    {"name":"role_permissions","fields":["role_permission_id","role_id","permission_id","access_level","is_enabled"]},
    {"name":"user_roles","fields":["user_role_id","user_id","role_id","assigned_at","assigned_by_user_id"]},
    {"name":"audit_log","fields":["audit_id","org_id","actor_user_id","action","entity_type","entity_id","before_json","after_json","ip_address","created_at"]},

    {"name":"customers","fields":["customer_id","org_id","customer_number","customer_name","industry","billing_terms","tax_exempt","invoice_delivery","status","notes","created_at","updated_at","deleted_at"]},
    {"name":"customer_contacts","fields":["contact_id","org_id","customer_id","first_name","last_name","email","phone","contact_role","preferred_channel","is_active","notes","created_at","updated_at"]},
    {"name":"locations","fields":["location_id","org_id","customer_id","location_number","location_name","facility_type","address_line1","address_line2","city","state","postal_code","country","timezone","square_footage","occupancy_level","traffic_level","default_service_frequency","security_level","special_instructions","geo_lat","geo_long","status","created_at","updated_at","deleted_at"]},
    {"name":"location_contacts","fields":["location_contact_id","location_id","contact_id","location_role","is_primary"]},
    {"name":"location_access","fields":["access_id","location_id","access_type","access_value","instructions","is_sensitive","status","effective_from","effective_to","updated_at"]},
    {"name":"location_areas","fields":["area_id","location_id","parent_area_id","area_name","area_type","area_code","area_sqft","is_serviceable","map_ref","created_at","updated_at"]},
    {"name":"area_fixtures","fields":["fixture_id","area_id","fixture_type","quantity","notes","updated_at"]},

    {"name":"service_categories","fields":["service_category_id","org_id","category_name","description","sort_order","is_active"]},
    {"name":"services","fields":["service_id","org_id","service_category_id","service_name","service_type","description","billing_model","is_active","created_at","updated_at"]},
    {"name":"task_categories","fields":["task_category_id","org_id","category_name","default_area_type","is_active"]},
    {"name":"tasks","fields":["task_id","org_id","task_category_id","task_name","task_description","unit_type","default_minutes_per_unit","default_units_per_hour","compliance_standard","qc_weight","requires_chemical","requires_ppe","is_active","created_at","updated_at"]},
    {"name":"service_tasks","fields":["service_task_id","service_id","task_id","default_frequency","default_area_type_filter","default_units","qc_weight_override","sort_order"]},
    {"name":"task_production_rates","fields":["rate_id","task_id","facility_type","source","minutes_per_unit","unit_type","effective_date","notes","is_active"]},
    {"name":"checklist_templates","fields":["checklist_template_id","org_id","template_name","template_type","version","is_active","created_by_user_id","created_at","updated_at"]},
    {"name":"checklist_template_sections","fields":["section_id","checklist_template_id","section_title","sort_order","is_active"]},
    {"name":"checklist_template_items","fields":["item_id","checklist_template_id","section_id","task_id","prompt","response_type","weight","applies_to_area_type","is_required","sort_order","is_active"]},

    {"name":"leads","fields":["lead_id","org_id","company_name","primary_contact_name","primary_email","primary_phone","source","status","owner_user_id","expected_close_date","estimated_value","notes","created_at","updated_at"]},
    {"name":"opportunities","fields":["opportunity_id","lead_id","pipeline_stage","expected_mrr","expected_arr","target_start_date","close_reason","notes"]},
    {"name":"quotes","fields":["quote_id","org_id","lead_id","customer_id","location_id","prepared_by_user_id","quote_number","quote_date","valid_until","status","pricing_basis","subtotal","tax_amount","discount_amount","total","scope_summary","assumptions","exclusions","approved_at","approved_by_user_id","converted_contract_id","created_at","updated_at"]},
    {"name":"quote_line_items","fields":["quote_line_item_id","quote_id","line_type","description","quantity","uom","unit_price","line_total","sort_order","is_optional_addon"]},
    {"name":"quote_workload_inputs","fields":["workload_input_id","quote_id","location_id","area_id","task_id","units","unit_type","minutes_per_unit","estimated_minutes_total","notes"]},

    {"name":"contracts","fields":["contract_id","org_id","customer_id","contract_number","contract_name","start_date","end_date","billing_cycle","contract_value_mrr","contract_value_arr","price_type","auto_renew","renewal_term_months","status","client_signed_at","company_signed_at","scope_of_work","exclusions","created_at","updated_at"]},
    {"name":"contract_locations","fields":["contract_location_id","contract_id","location_id","is_primary","notes"]},
    {"name":"contract_service_lines","fields":["contract_service_line_id","contract_id","service_id","frequency","unit_price","estimated_labor_hours_per_period","included_in_base","sort_order"]},
    {"name":"recurrence_rules","fields":["recurrence_rule_id","contract_id","location_id","service_id","recurrence_type","days_of_week","rrule_text","default_start_time","default_duration_minutes","effective_from","effective_to","is_active"]},
    {"name":"contract_slas","fields":["sla_id","contract_id","sla_type","target_minutes","target_score","severity","notes"]},

    {"name":"jobs","fields":["job_id","org_id","customer_id","location_id","contract_id","recurrence_rule_id","job_number","job_type","service_window","service_date","scheduled_start_time","scheduled_duration_minutes","priority","status","checklist_template_id","client_visible_notes","internal_notes","billable","created_at","updated_at"]},
    {"name":"job_visits","fields":["job_visit_id","job_id","visit_type","planned_start","planned_end","actual_start","actual_end","status","notes"]},
    {"name":"job_assignments","fields":["job_assignment_id","job_id","job_visit_id","employee_id","assignment_role","assignment_status","sort_order","assigned_at"]},
    {"name":"job_tasks","fields":["job_task_id","job_id","area_id","task_id","frequency_instance","planned_units","planned_minutes","completion_status","completion_notes","completion_photos","completed_at","completed_by_employee_id"]},
    {"name":"job_status_events","fields":["job_status_event_id","job_id","from_status","to_status","changed_by_user_id","reason","changed_at"]},
    {"name":"routes","fields":["route_id","org_id","route_date","route_owner_employee_id","route_type","status","created_at"]},
    {"name":"route_stops","fields":["route_stop_id","route_id","job_id","stop_order","estimated_travel_minutes","is_locked"]},

    {"name":"geofences","fields":["geofence_id","location_id","center_lat","center_long","radius_meters","is_active"]},
    {"name":"nfc_tags","fields":["nfc_tag_id","location_id","area_id","tag_code","tag_purpose","installed_location_note","is_active"]},
    {"name":"time_punches","fields":["time_punch_id","org_id","employee_id","job_id","job_visit_id","punch_type","method","lat","long","geofence_id","nfc_tag_id","within_geofence","note","punched_at"]},
    {"name":"time_entries","fields":["time_entry_id","org_id","employee_id","job_id","job_visit_id","clock_in_at","clock_out_at","work_minutes","break_minutes","pay_code","is_approved","approved_by_user_id","approved_at","approval_notes","created_at"]},
    {"name":"time_policies","fields":["time_policy_id","org_id","policy_name","clock_in_restriction","early_clock_in_minutes","late_clock_out_minutes","requires_photo_on_manual_edit","is_active"]},

    {"name":"inspection_templates","fields":["inspection_template_id","org_id","template_name","scoring_model","requires_signature","requires_photos","version","is_active"]},
    {"name":"inspection_template_items","fields":["inspection_template_item_id","inspection_template_id","item_name","item_description","area_type","weight","is_required","sort_order"]},
    {"name":"inspections","fields":["inspection_id","org_id","location_id","job_id","inspection_template_id","inspector_employee_id","inspection_date","status","score","rating","summary_notes","signature_url","photos","submitted_at","closed_at"]},
    {"name":"inspection_items","fields":["inspection_item_id","inspection_id","inspection_template_item_id","area_id","result","score_value","notes","photos"]},

    {"name":"issues","fields":["issue_id","org_id","customer_id","location_id","job_id","inspection_id","issue_type","priority","status","title","description","client_visible","reported_by_user_id","assigned_to_employee_id","reported_at","due_at","resolved_at","resolution_notes","attachments","updated_at"]},
    {"name":"issue_comments","fields":["issue_comment_id","issue_id","author_user_id","comment_body","client_visible","created_at"]},
    {"name":"issue_work_logs","fields":["issue_work_log_id","issue_id","employee_id","minutes_spent","notes","logged_at"]},

    {"name":"vendors","fields":["vendor_id","org_id","vendor_name","phone","email","website_url","payment_terms","status","updated_at"]},
    {"name":"inventory_locations","fields":["inventory_location_id","org_id","location_type","location_id","name","address_note","is_active"]},
    {"name":"items","fields":["item_id","org_id","sku","item_name","item_category","uom","unit_cost","unit_price","reorder_point","reorder_qty","is_hazardous","sds_url","is_active","updated_at"]},
    {"name":"stock_levels","fields":["stock_level_id","inventory_location_id","item_id","quantity_on_hand","quantity_reserved","updated_at"]},
    {"name":"stock_movements","fields":["stock_movement_id","item_id","from_inventory_location_id","to_inventory_location_id","movement_type","quantity","unit_cost","related_job_id","performed_by_user_id","notes","moved_at"]},
    {"name":"purchase_orders","fields":["purchase_order_id","org_id","vendor_id","po_number","po_date","status","ship_to_inventory_location_id","subtotal","tax","total","notes","updated_at"]},
    {"name":"purchase_order_lines","fields":["purchase_order_line_id","purchase_order_id","item_id","quantity_ordered","quantity_received","unit_cost","line_total"]},
    {"name":"supply_requests","fields":["supply_request_id","org_id","location_id","inventory_location_id","requested_by_employee_id","status","notes","requested_at","updated_at"]},
    {"name":"supply_request_lines","fields":["supply_request_line_id","supply_request_id","item_id","quantity_requested","quantity_fulfilled","line_notes"]},

    {"name":"assets","fields":["asset_id","org_id","asset_name","asset_type","serial_number","manufacturer","model","purchase_date","purchase_cost","warranty_expires_at","status","current_inventory_location_id","current_location_id","track_via_scan","scan_code","notes","updated_at"]},
    {"name":"asset_transfers","fields":["asset_transfer_id","asset_id","from_inventory_location_id","to_inventory_location_id","from_location_id","to_location_id","performed_by_user_id","notes","transferred_at"]},
    {"name":"asset_maintenance_logs","fields":["asset_maintenance_log_id","asset_id","maintenance_type","performed_on","cost","details","performed_by_employee_id","created_at"]},

    {"name":"invoices","fields":["invoice_id","org_id","customer_id","contract_id","invoice_number","issue_date","due_date","terms","status","subtotal","tax_amount","discount_amount","total","balance_due","pdf_url","notes","sent_at","updated_at"]},
    {"name":"invoice_line_items","fields":["invoice_line_item_id","invoice_id","line_type","description","quantity","uom","unit_price","line_total","sort_order"]},
    {"name":"invoice_jobs","fields":["invoice_job_id","invoice_id","job_id","is_consolidated"]},
    {"name":"payments","fields":["payment_id","invoice_id","payment_date","payment_method","amount","transaction_id","status","processed_by_user_id","notes","created_at"]},

    {"name":"pay_periods","fields":["pay_period_id","org_id","period_start","period_end","pay_date","status","updated_at"]},
    {"name":"payroll_runs","fields":["payroll_run_id","pay_period_id","run_type","status","approved_by_user_id","approved_at","created_at"]},
    {"name":"earning_codes","fields":["earning_code_id","org_id","code","name","type","is_active"]},
    {"name":"payroll_line_items","fields":["payroll_line_item_id","payroll_run_id","employee_id","earning_code_id","hours","rate","amount","notes"]},

    {"name":"conversations","fields":["conversation_id","org_id","conversation_type","job_id","location_id","issue_id","title","created_at"]},
    {"name":"conversation_participants","fields":["conversation_participant_id","conversation_id","user_id","participant_role","is_muted","joined_at"]},
    {"name":"messages","fields":["message_id","conversation_id","sender_user_id","channel","body","attachments_json","is_system_message","sent_at"]},
    {"name":"notifications","fields":["notification_id","user_id","notification_type","payload_json","is_read","created_at","read_at"]},
    {"name":"notification_preferences","fields":["notification_preference_id","user_id","default_channel","quiet_hours_enabled","quiet_hours_start","quiet_hours_end"]},

    {"name":"files","fields":["file_id","org_id","file_name","content_type","byte_size","storage_provider","storage_key","uploaded_by_user_id","uploaded_at","is_private"]},
    {"name":"file_links","fields":["file_link_id","file_id","entity_type","entity_id","label","linked_at"]},
    {"name":"tags","fields":["tag_id","org_id","tag_name","color_hex"]},
    {"name":"tag_assignments","fields":["tag_assignment_id","tag_id","entity_type","entity_id","assigned_at"]},
    {"name":"custom_fields","fields":["custom_field_id","org_id","entity_type","field_key","field_label","field_type","is_required","is_active"]},
    {"name":"custom_field_options","fields":["custom_field_option_id","custom_field_id","option_label","option_value","sort_order"]},
    {"name":"custom_field_values","fields":["custom_field_value_id","custom_field_id","entity_id","value_text","value_number","value_date","value_bool","value_json"]},

    {"name":"integration_connections","fields":["integration_connection_id","org_id","integration_type","provider_name","status","api_key_encrypted","oauth_json","last_sync_at","updated_at"]},
    {"name":"integration_sync_logs","fields":["sync_log_id","integration_connection_id","sync_direction","status","summary","details_json","started_at"]},
    {"name":"webhooks","fields":["webhook_id","org_id","target_url","event_type","secret_token","is_active","updated_at"]},
    {"name":"external_id_map","fields":["external_id_map_id","integration_connection_id","entity_type","internal_entity_id","external_entity_id","updated_at"]}
  ]
}
